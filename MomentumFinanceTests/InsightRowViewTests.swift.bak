import XCTest
@testable import MomentumFinance

class InsightRowViewTests: XCTestCase {
    var insightRowView: InsightRowView!

    
    }

    

    // Test the body of the InsightRowView
    func testBody() {
        // GIVEN
        let mockInsight = FinancialInsight(title: "Test Insight", description: "This is a test insight.", type: .critical, confidence: 0.85)
        let mockAction = { /* Mock action */ }
        insightRowView = InsightRowView(insight: mockInsight) { mockAction }

        // WHEN
        let body = insightRowView.body

        // THEN
        XCTAssertEqual(body.count, 6) // 2 text views + 3 HStacks + 1 Spacer + 1 Image
        XCTAssertTrue(body.contains(Circle())) // Priority indicator
        XCTAssertTrue(body.contains(Text("Test Insight"))) // Title
        XCTAssertTrue(body.contains(Text("This is a test insight."))) // Description
        XCTAssertTrue(body.contains(Label(.critical, systemImage: "tag"))) // Type label
        XCTAssertTrue(body.contains(Text("85% confidence"))) // Confidence label
        XCTAssertTrue(body.contains(Image(systemName: "chevron.right"))) // Right arrow icon
    }

    // Test the priorityColor method
    func testPriorityColor() {
        // GIVEN
        let mockInsight = FinancialInsight(title: "Test Insight", description: "This is a test insight.", type: .critical, confidence: 0.85)

        // WHEN
        let color = insightRowView.priorityColor

        // THEN
        XCTAssertEqual(color, .red)
    }

    // Test the action method
    func testAction() {
        // GIVEN
        let mockInsight = FinancialInsight(title: "Test Insight", description: "This is a test insight.", type: .critical, confidence: 0.85)
        var called = false

        let mockAction = { called = true }

        insightRowView = InsightRowView(insight: mockInsight) { mockAction }

        // WHEN
        insightRowView.action()

        // THEN
        XCTAssertTrue(called)
    }
}
